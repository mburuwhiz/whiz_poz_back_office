<%- contentFor('body') %>

<div class="mb-6 flex items-center justify-between">
    <div>
        <h2 class="text-2xl font-bold text-gray-900">Salaries & Advances</h2>
        <p class="text-sm text-gray-500">Manage employee salaries and advance payments</p>
    </div>
    <button onclick="document.getElementById('addSalaryModal').showModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
        <i data-lucide="plus" class="w-4 h-4"></i> Record Payment
    </button>
</div>

<!-- Salaries List -->
<div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
    <div class="overflow-x-auto">
        <table class="w-full text-sm text-left">
            <thead class="bg-gray-50 text-gray-600 font-medium border-b border-gray-100">
                <tr>
                    <th class="px-6 py-4">Date</th>
                    <th class="px-6 py-4">Employee</th>
                    <th class="px-6 py-4">Type</th>
                    <th class="px-6 py-4">Notes</th>
                    <th class="px-6 py-4 text-right">Amount</th>
                    <th class="px-6 py-4 text-center">Actions</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
                <% if (salaries && salaries.length > 0) { %>
                    <% salaries.forEach(salary => { %>
                    <tr class="hover:bg-gray-50/50">
                        <td class="px-6 py-4 text-gray-600">
                            <%= new Date(salary.date).toLocaleDateString() %>
                        </td>
                        <td class="px-6 py-4 font-medium text-gray-900"><%= salary.employeeName %></td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full <%= salary.type === 'full' ? 'bg-blue-100 text-blue-700' : 'bg-orange-100 text-orange-700' %> uppercase">
                                <%= salary.type %>
                            </span>
                        </td>
                        <td class="px-6 py-4 text-gray-500 max-w-xs truncate"><%= salary.notes || '-' %></td>
                        <td class="px-6 py-4 text-right font-medium text-gray-900">
                            Ksh. <%= salary.amount.toLocaleString() %>
                        </td>
                        <td class="px-6 py-4 text-center">
                            <form action="/salaries/delete/<%= salary.salaryId %>" method="POST" onsubmit="return confirm('Delete this record?');" class="inline">
                                <button type="submit" class="text-gray-400 hover:text-red-600 transition-colors">
                                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                                </button>
                            </form>
                        </td>
                    </tr>
                    <% }) %>
                <% } else { %>
                    <tr>
                        <td colspan="6" class="px-6 py-12 text-center text-gray-500">
                            <i data-lucide="dollar-sign" class="w-12 h-12 mx-auto mb-3 text-gray-300"></i>
                            <p>No salary records found.</p>
                        </td>
                    </tr>
                <% } %>
            </tbody>
        </table>
    </div>
</div>

<!-- Add Modal -->
<dialog id="addSalaryModal" class="modal rounded-xl shadow-xl p-0 w-full max-w-md backdrop:bg-black/50">
    <div class="bg-white">
        <div class="px-6 py-4 border-b border-gray-100 flex items-center justify-between">
            <h3 class="font-bold text-lg">Record Salary Payment</h3>
            <button onclick="document.getElementById('addSalaryModal').close()" class="text-gray-400 hover:text-gray-600">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>
        </div>
        <form action="/salaries/add" method="POST" class="p-6 space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Employee Name</label>
                <input type="text" name="employeeName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Amount (Ksh)</label>
                <input type="number" name="amount" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Payment Type</label>
                <select name="type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white">
                    <option value="full">Full Salary</option>
                    <option value="advance">Advance Payment</option>
                </select>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                <input type="date" name="date" required value="<%= new Date().toISOString().split('T')[0] %>" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Notes</label>
                <textarea name="notes" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none resize-none"></textarea>
            </div>

            <div class="pt-4 flex gap-3">
                <button type="button" onclick="document.getElementById('addSalaryModal').close()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">Cancel</button>
                <button type="submit" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">Save Record</button>
            </div>
        </form>
    </div>
</dialog>
